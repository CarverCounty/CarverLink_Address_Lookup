
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no" />
    <title>CarverLink!!</title>
	<!-- <script id ="addyList" src="addy.csv"></script> -->
    <script src="https://js.arcgis.com/calcite-components/1.4.2/calcite.esm.js" type="module"></script>
    <link rel="stylesheet" href="https://js.arcgis.com/calcite-components/1.4.2/calcite.css" />

    <!-- <script src="https://js.arcgis.com/4.26/"></script> -->
    <!-- <link rel="stylesheet" href="https://js.arcgis.com/4.26/esri/themes/light/main.css" /> -->
	
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="" />
 
	<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
    <!-- Load Esri Leaflet from CDN -->
    <script src="https://unpkg.com/esri-leaflet@3.0.10/dist/esri-leaflet.js"></script>

  </head>
  <style>
    html,
    body,
    #viewDiv {
      padding: 0px;
      margin: 0;
      height: 100%;
      width: 100%;
    }
  </style>
  <body> 


	<calcite-shell content-behind >
  <calcite-combobox id="address-select" placeholder="Enter An Address!" selection-mode="single" on>
    <!-- <calcite-combobox-item value="Natural Resources" text-label="Natural Resources"></calcite-combobox-item> -->
    <!-- <calcite-combobox-item value="Agriculture" text-label="Agriculture"></calcite-combobox-item> -->
    <!-- <calcite-combobox-item value="Forestry" text-label="Forestry"></calcite-combobox-item> -->
    <!-- <calcite-combobox-item value="Mining" text-label="Mining"></calcite-combobox-item> -->
    <!-- <calcite-combobox-item value="Business" text-label="Business"></calcite-combobox-item> -->
    <!-- <calcite-combobox-item value="Education" text-label="Education"></calcite-combobox-item> -->
    <!-- <calcite-combobox-item value="Utilities" text-label="Utilities"></calcite-combobox-item> -->
    <!-- <calcite-combobox-item value="Transportation" text-label="Transportation"></calcite-combobox-item> -->
   </calcite-combobox>
		<calcite-shell-panel slot="panel-start" display-mode="float">
		</calcite-shell-panel>
		<div id="viewDiv"><div id="map" class="hidem"></div></div>
	</calcite-shell>
	


 <script>

      const apiKey = "AAPKaea27064e50c4ad1a90b2d34e03ba8f5jFvKxjZjOlhObw6kONRLgO7M0KTU5jkMJIlqH4XB8nbaTARSJSlAMM9TJ3DbPzwg";

      const map = L.map("map", {
        minZoom: 2
      }).setView([44.8, -93.85], 19); //Latitude, longitude

      L.esri
        .tiledMapLayer({
          url: "https://tiles.arcgis.com/tiles/wMZT8kNwa6tOxhKg/arcgis/rest/services/2022_Tiled_Imagery_282/MapServer",
		  apiKey: apiKey,
          detectRetina: false,
          minZoom: 3,
          maxZoom: 19
        }).addTo(map);

	const popup = L.popup()
		.setLatLng([44.7, -93.2])
		.setContent('I am a standalone popup.')
		.openOn(map);

    </script>
  </body>	
  <script>
  window.addEventListener('load', () => {
    const testComboBox = document.getElementById('address-select');
    testComboBox.addEventListener("calciteComboboxFilterChange", calciteComboboxChangeEvt => {
		<!-- var theAddress = document.getElementById('address-select').value; -->
		groom("Matt");
		popit(1);
    });
	const testComboBox2 = document.getElementById('address-select');
    testComboBox2.addEventListener("calciteComboboxChange", calciteComboboxChangeEvt => {
	var theAddress = document.getElementById('address-select').value;
	groom(theAddress);
	<!-- if (theAddress == "Mining"){ -->
		<!-- document.getElementById('viewDiv').style.visibility = 'hidden' -->
	<!-- } else { -->
		<!-- document.getElementById('viewDiv').style.visibility = 'visible' -->
	<!-- } -->
    });

     function popit(iVal){
				var tmpVal = "1";
				console.log(iVal);
				var theWhere = "Street like '"+iVal+"%'";console.log(theWhere);
				var query = L.esri.query({
				   url: 'https://services.arcgis.com/wMZT8kNwa6tOxhKg/ArcGIS/rest/services/addy_20230622_ago/FeatureServer/0'
				});

				query.where(theWhere);
				query.returnGeometry(false);
				query.limit(25);
const combobox = document.getElementById("address-select");
				query.run(function (error, featureCollection, response) {
					if (error) {
					   console.log(error);
					   return;
					}
					combobox.innerHTML = "";
					var features = featureCollection.features;
					zzz=  features;
					console.log(features);
					var addressList = [];
					
					for (var iIndex = 0; iIndex < features.length; ++iIndex){
						iFeature = features[iIndex];
						thisAddy = iFeature.properties.Street;
						addressList.push({name:thisAddy, id:thisAddy});
						const item = document.createElement("calcite-combobox-item");
						item.value = thisAddy;
						item.textLabel = thisAddy;
						combobox.appendChild(item);
					}
					combobox.open = true;
					combobox.setFocus();
					console.log(addressList);
					console.log('Found ' + features.length + ' features');
					<!-- dojo.byId("addressCombobox").store = filterStore; -->
					<!-- console.log(dojo.byId("addressCombobox").value); -->
			   
			});
}
	
	function groom(i){
	console.log(i);
	}	

	popit(1);
  }, false);
</script>

</html>